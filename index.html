function sendAll() {
  const trasa = document.getElementById("trasa").value.trim();
  const nrRejestracyjny = document.getElementById("nrRejestracyjny").value.trim();
  const dostawa = document.getElementById("dostawa").value.trim();
  const info = document.getElementById("info").value.trim();
  const moduly = document.getElementById("moduly").value.trim();

  if (!trasa || !nrRejestracyjny || codes.length === 0) {
    alert("Uzupełnij wymagane pola i dodaj przynajmniej jeden kod.");
    return;
  }

  fetch(scriptURL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      trasa: trasa,
      nrRejestracyjny: nrRejestracyjny,
      dostawa: dostawa,
      info: info,
      moduly: moduly,
      codes: codes
    })
  })
  .then(res => res.text())
  .then(txt => {
    document.getElementById("status").innerText = "✅ Wysłano dane do arkusza.";
    codes = [];
    updateList();
  })
  .catch(err => alert("Błąd: " + err));
}
